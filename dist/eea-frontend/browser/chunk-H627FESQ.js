import{D as g,E as _,F as o,G as S,J as I,L as C,a as d,b as f,c as v}from"./chunk-SO5ZPU35.js";import{a as m}from"./chunk-OH2Y4EI7.js";import{b as u,e as l}from"./chunk-6ZFPSLVZ.js";import{P as h,V as a,s as r}from"./chunk-G6EWFTW4.js";import{a as c,b as p}from"./chunk-ACKELEN3.js";var H=class n{_auth=a(S);_authService=a(v);_httpClient=a(l);_apiUrl=`${m.API_URL}/auth`;_coreService=a(f);_customMessageService=a(d);signUp(i){return I(this._auth,i.email,i.password)}signIn(i){let e=`${this._apiUrl}/sign-in`;return this._httpClient.post(e,i).pipe(r(t=>(this._authService.accessToken=t.data.accessToken,this._authService.auth=t.data.auth,this._authService.roles=t.data.roles,t.data.roles.length===1&&(this._authService.role=t.data.roles[0]),this._customMessageService.showSuccess({summary:t.title,detail:t.message}),t)))}signInWithPopup(i){let e=null;switch(i){case"google":e=new o;break;case"microsoft":e=new g("microsoft.com");break;case"facebook":e=new _;break;default:e=new o}return e.setCustomParameters({prompt:"select_account"}),C(this._auth,e)}requestTransactionalCode(i){let e=`${this._apiUrl}/transactional-codes/${i}/request`;return this._httpClient.get(e).pipe(r(t=>(this._customMessageService.showHttpSuccess(t),t.data)))}requestTransactionalEmailCode(i){let e=`${this._apiUrl}/transactional-email-codes/${i}/request`;return this._httpClient.get(e).pipe(r(t=>(this._customMessageService.showHttpSuccess(t),t.data)))}verifyTransactionalCode(i,e){let t=`${this._apiUrl}/transactional-codes/${i}/verify`;return this._httpClient.patch(t,{username:e}).pipe(r(s=>(this._customMessageService.showHttpSuccess(s),s.data)))}verifyRecaptcha(i){let e=`${this._apiUrl}/verify-recaptcha`,t=new u().set("token",i);return this._httpClient.post(e,null,{params:t}).pipe(r(s=>(s||this._customMessageService.showError({summary:"No pas\xF3 la validaci\xF3n de reCAPTCHA",detail:"Por favor vuelva a intentar"}),s.data)))}verifyIdentification(i){let e=`${this._apiUrl}/verify-identification/${i}`;return this._httpClient.get(e).pipe(r(t=>t.data))}signInByValidationIdentification(i){let e=`${this._apiUrl}/sign-in-validation-identification/${i}`;return this._httpClient.get(e).pipe(r(t=>(this._authService.accessToken=t.data.accessToken,this._authService.auth=t.data.auth,this._authService.roles=t.data.roles,t.data.roles.length===1&&(this._authService.role=t.data.roles[0]),this._customMessageService.showSuccess({summary:t.title,detail:t.message}),t)))}acceptTermsConditions(){let i=`${this._apiUrl}/terms-conditions/accept`;return this._httpClient.patch(i,null).pipe(r(e=>(this._authService.auth=p(c({},this._authService.auth),{termsConditions:!0}),this._customMessageService.showHttpSuccess(e),e.data)))}rejectTermsConditions(){let i=`${this._apiUrl}/terms-conditions/reject`;return this._httpClient.patch(i,null).pipe(r(e=>(this._customMessageService.showHttpSuccess(e),e.data)))}static \u0275fac=function(e){return new(e||n)};static \u0275prov=h({token:n,factory:n.\u0275fac,providedIn:"root"})};export{H as a};
