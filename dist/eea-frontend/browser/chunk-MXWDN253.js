import{a as $,b as te}from"./chunk-3CETPCZI.js";import{b as ee}from"./chunk-RNX5ZUBP.js";import{a as Z}from"./chunk-5HSAOL7C.js";import"./chunk-SMZRKWGV.js";import"./chunk-WTBP2LYV.js";import{a as Y}from"./chunk-5ZBR4LS2.js";import{a as X}from"./chunk-IE4355C3.js";import{a as K}from"./chunk-OHER5PLG.js";import{a as k}from"./chunk-GOQ3JMUW.js";import{a as Q}from"./chunk-XMBKP4VC.js";import"./chunk-3AXKVFIO.js";import"./chunk-MPLAKOWK.js";import"./chunk-DPC2C23C.js";import"./chunk-LUSM3YRN.js";import"./chunk-MJNRKRDT.js";import{a as V}from"./chunk-UIVIJWLM.js";import{a as z,b as W}from"./chunk-AF3X7UOH.js";import{a as P}from"./chunk-RJ6ODVGJ.js";import"./chunk-VGCEVFP6.js";import"./chunk-WCGJ44IN.js";import{a as E,b as A,c as N,d as D,f as R,h as f,j as B,k as G,n as H,p as L,r as U,s as j,t as q,u as O,v as J}from"./chunk-UOAM75BV.js";import{Na as M,Pa as T,Qa as w,m as S,ra as I,s as F}from"./chunk-RIYVHW5G.js";import{Ab as r,Bb as a,Fb as C,Gb as g,Hb as u,Sa as o,Sb as l,Ub as v,W as m,ca as b,da as x,db as _,ib as p,qb as d,vb as c,zb as s}from"./chunk-5MZ4X5ZA.js";import"./chunk-ACKELEN3.js";function ie(i,e){if(i&1&&(s(0,"h1",5),l(1),r()),i&2){let t=u();o(),v(" ",t.environment.APP_SHORT_NAME," ")}}function oe(i,e){i&1&&(l(0," Fecha de "),a(1,"p-tag",18),l(2," de la c\xE9dula: "))}function ne(i,e){i&1&&(l(0," Fecha de "),a(1,"p-tag",19),l(2," de la c\xE9dula: "))}function re(i,e){if(i&1&&(s(0,"div")(1,"label",14),p(2,oe,3,0)(3,ne,3,0),r(),a(4,"p-select",15)(5,"p-select",16)(6,"p-select",17),r()),i&2){let t=u();o(2),c(t.validationType==="issue"?2:3),o(2),d("options",t.years),o(),d("options",t.months),o(),d("options",t.days)}}function ae(i,e){if(i&1){let t=C();s(0,"p-button",20),g("onClick",function(){b(t);let h=u();return x(h.verifyIdentification())}),r()}if(i&2){let t=u();d("loading",t._coreService.loading())("icon",t.PrimeIcons.ARROW_RIGHT)}}function se(i,e){if(i&1&&a(0,"p-button",13),i&2){let t=u();d("loading",t._coreService.loading())("icon",t.PrimeIcons.SIGN_IN)}}var y=class i{_formBuilder=m(q);_customMessageService=m(A);_authHttpService=m(K);_userHttpService=m(X);_authService=m(D);_coreService=m(N);_router=m(S);PrimeIcons=I;environment=E;form;formErrors=[];validationType="";dateLabel="";years=[];months=[];days=[];identification;constructor(){this.buildForm();for(let e=2035;e>1950;e--)this.years.push({code:e,name:e});this.days=Array.from({length:31},(e,t)=>t+1),this.months=[{code:1,name:"01 Enero"},{code:2,name:"02 Febrero"},{code:3,name:"03 Marzo"},{code:4,name:"04 Abril"},{code:5,name:"05 Mayo"},{code:6,name:"06 Junio"},{code:7,name:"07 Julio"},{code:8,name:"08 Agosto"},{code:9,name:"09 Septiembre"},{code:10,name:"10 Octubre"},{code:11,name:"11 Noviembre"},{code:12,name:"12 Diciembre"}],this.usernameField.valueChanges.subscribe(e=>{this.identification&&this.assignValidationType(this.identification),e.length!=10&&(this.identification=null),e.length===10&&this.verifyIdentification()})}buildForm(){this.form=this._formBuilder.group({username:[null,[f.required]],type:[null],year:[null,[f.required]],month:[null,[f.required]],day:[null,[f.required]]})}onSubmit(){if(!this.validateForm()){this.form.markAllAsTouched(),this._customMessageService.showFormErrors(this.formErrors);return}this.validate()}validate(){let e=this.identification.fechaEmision.substring(6,10),t=this.identification.fechaEmision.substring(3,5),n=this.identification.fechaEmision.substring(0,2);if(this.dateLabel="Fecha de emisi\xF3n de la c\xE9dula",this.validationType==="expiration"&&(this.dateLabel="Fecha de expiraci\xF3n de la c\xE9dula",e=this.identification.fechaExpiracion.substring(6,10),t=this.identification.fechaExpiracion.substring(3,5),n=this.identification.fechaExpiracion.substring(0,2)),parseInt(e)!=this.yearField.value.code||parseInt(t)!=this.monthField.value.code||parseInt(n)!=this.dayField.value){this._customMessageService.showError({summary:this.dateLabel,detail:"No coincide con su c\xE9dula"});return}this._authHttpService.signInByValidationIdentification(this.usernameField.value).subscribe({next:h=>{this._router.navigateByUrl(k.pages.states.absolute)}})}validateForm(){return this.formErrors=[],this.usernameField&&this.usernameField.invalid&&this.formErrors.push("Usuario"),this.yearField&&this.yearField.invalid&&this.formErrors.push("A\xF1o"),this.monthField&&this.monthField.invalid&&this.formErrors.push("Mes"),this.dayField&&this.dayField.invalid&&this.formErrors.push("D\xEDa"),this.formErrors.length===0&&this.form.valid}verifyIdentification(){this.identification=null,this.usernameField.value.length==10?this._authHttpService.verifyIdentification(this.usernameField.value).subscribe({next:e=>{this.identification=e,this.assignValidationType(this.identification)}}):this._customMessageService.showError({summary:"Debe ingresar una c\xE9dula v\xE1lida",detail:"Intente de nuevo"})}assignValidationType(e){!e.fechaExpiracion||e.fechaExpiracion===""?this.validationType="issue":this.validationType=Math.floor(Math.random()*2)+1===1?"issue":"expiration"}get usernameField(){return this.form.controls.username}get yearField(){return this.form.controls.year}get monthField(){return this.form.controls.month}get dayField(){return this.form.controls.day}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=_({type:i,selectors:[["app-sign-in"]],decls:22,vars:7,consts:[[1,"bg-surface-50","dark:bg-surface-950","flex","items-center","justify-center","min-h-screen","min-w-[100vw]","overflow-hidden"],[1,"flex","flex-col","items-center","justify-center"],[2,"border-radius","56px","padding","0.4rem","background","linear-gradient(180deg, var(--primary-color) 10%, rgba(33, 150, 243, 0) 100%)"],[1,"w-full","bg-surface-0","dark:bg-surface-900","py-10","px-8","sm:px-6",2,"border-radius","53px"],[1,"text-center","mb-0"],[1,"text-red-500"],["src","images/logo.png","alt","","width","150"],[1,"text-surface-950","dark:text-surface-0","text-3xl","font-medium","mb-4"],[1,"text-muted-color","font-medium"],[3,"ngSubmit","formGroup"],["for","username",1,"block","text-surface-900","dark:text-surface-0","text-xl","font-medium","mb-2"],["pInputText","","pKeyFilter","int","id","username","type","text","placeholder","Ej. 1702030405","formControlName","username",1,"w-full","md:w-[39rem]","mb-4",3,"maxlength"],["type","button","label","Continuar","styleClass","w-full","iconPos","right",3,"loading","icon"],["type","submit","label","Continuar","styleClass","w-full",3,"loading","icon"],[1,"block","text-surface-900","dark:text-surface-0","font-medium","text-xl","mb-2"],["id","year","formControlName","year","placeholder","A\xF1o","optionLabel","name",1,"w-full","md:w-56","mr-2",3,"options"],["id","month","formControlName","month","placeholder","Mes","optionLabel","name",1,"w-full","md:w-56","mr-2",3,"options"],["id","day","formControlName","day","placeholder","D\xEDa",1,"w-full","md:w-56","mr-2",3,"options"],["value","EMISI\xD3N","severity","info"],["value","EXPIRACI\xD3N","severity","danger"],["type","button","label","Continuar","styleClass","w-full","iconPos","right",3,"onClick","loading","icon"]],template:function(t,n){t&1&&(a(0,"app-floating-configurator"),s(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4),p(6,ie,2,1,"h1",5),a(7,"img",6),s(8,"div",7),l(9," Iniciar Sesi\xF3n "),r(),s(10,"span",8),l(11),r()(),a(12,"p-divider"),s(13,"form",9),g("ngSubmit",function(){return n.onSubmit()}),s(14,"div")(15,"label",10),l(16," N\xFAmero de c\xE9dula: "),r(),a(17,"input",11),r(),p(18,re,7,4,"div"),a(19,"p-divider"),p(20,ae,1,2,"p-button",12)(21,se,1,2,"p-button",13),r()()()()()),t&2&&(o(6),c(n.environment.production?-1:6),o(5),v(" Bienvenido a ",n.environment.APP_NAME," "),o(2),d("formGroup",n.form),o(4),d("maxlength",10),o(),c(n.identification?18:-1),o(2),c(n.identification?-1:20),o(),c(n.identification?21:-1))},dependencies:[w,T,$,W,z,ee,O,H,R,B,G,j,F,M,J,L,U,Z,te,P,Q,Y,V],encapsulation:2})};export{y as default};
