import{b as fe,c as he}from"./chunk-6HNJSXSQ.js";import{d as ae}from"./chunk-QC2FJJGV.js";import{a as de,b as me,c as ue,d as ce,e as pe}from"./chunk-JT73Z5OK.js";import{a as ie}from"./chunk-HR7FCAVZ.js";import"./chunk-JGQTFYBY.js";import{f as se,g as le}from"./chunk-YMBSCKZF.js";import"./chunk-WCGJ44IN.js";import{e as oe}from"./chunk-MZ3R56TG.js";import{f as O,l as j}from"./chunk-C6LFFOYR.js";import{Ia as $,Ja as U,Ka as b,M as G,Ma as z,Na as Y,Pa as q,Ra as J,Sa as Q,Ua as W,Va as X,Wa as Z,Xa as ee,_a as te,mb as re,nb as ne,ta as L,z as f}from"./chunk-PMMND3ET.js";import{Da as w,Eb as p,Ia as D,Jb as k,K as S,Kc as T,L as x,Nb as d,Ob as s,Pb as u,Uc as B,Vb as g,Wb as N,_ as A,db as l,fa as m,gc as c,ib as h,ic as C,ld as H,nc as P,qb as V,sb as K,u as I,v as y,wb as R,za as F}from"./chunk-WRPGBDYM.js";var xe={provide:U,useExisting:A(()=>_),multi:!0},ge={pint:/^[\d]*$/,int:/^[-]?[\d]*$/,pnum:/^[\d\.]*$/,money:/^[\d\.\s,]*$/,num:/^[-]?[\d\.]*$/,hex:/^[0-9a-f]*$/i,email:/^[a-z0-9_\.\-@]*$/i,alpha:/^[a-z_]*$/i,alphanum:/^[a-z0-9_]*$/i},E={TAB:9,RETURN:13,ESC:27,BACKSPACE:8,DELETE:46},ve={63234:37,63235:39,63232:38,63233:40,63276:33,63277:34,63272:46,63273:36,63275:35},_=(()=>{class a{document;platformId;el;pValidateOnly;set pattern(t){this._pattern=t,t instanceof RegExp?this.regex=t:t in ge?this.regex=ge[t]:this.regex=/./}get pattern(){return this._pattern}ngModelChange=new F;regex=/./;_pattern;isAndroid;lastValue;constructor(t,e,i){this.document=t,this.platformId=e,this.el=i,H(this.platformId)?this.isAndroid=G():this.isAndroid=!1}isNavKeyPress(t){let e=t.keyCode;return e=f().safari&&ve[e]||e,e>=33&&e<=40||e==E.RETURN||e==E.TAB||e==E.ESC}isSpecialKey(t){let e=t.keyCode||t.charCode;return e==9||e==13||e==27||e==16||e==17||e>=18&&e<=20||f().opera&&!t.shiftKey&&(e==8||e>=33&&e<=35||e>=36&&e<=39||e>=44&&e<=45)}getKey(t){let e=t.keyCode||t.charCode;return f().safari&&ve[e]||e}getCharCode(t){return t.charCode||t.keyCode||t.which}findDelta(t,e){let i="";for(let r=0;r<t.length;r++)t.substr(0,r)+t.substr(r+t.length-e.length)===e&&(i=t.substr(r,t.length-e.length));return i}isValidChar(t){return this.regex.test(t)}isValidString(t){for(let e=0;e<t.length;e++)if(!this.isValidChar(t.substr(e,1)))return!1;return!0}onInput(t){if(this.isAndroid&&!this.pValidateOnly){let e=this.el.nativeElement.value,i=this.lastValue||"",r=this.findDelta(e,i),n=this.findDelta(i,e);r.length>1||!r&&!n?this.isValidString(e)||(this.el.nativeElement.value=i,this.ngModelChange.emit(i)):n||this.isValidChar(r)||(this.el.nativeElement.value=i,this.ngModelChange.emit(i)),e=this.el.nativeElement.value,this.isValidString(e)&&(this.lastValue=e)}}onKeyPress(t){if(this.isAndroid||this.pValidateOnly)return;let e=f(),i=this.getKey(t);if(e.mozilla&&(t.ctrlKey||t.altKey))return;if(i==17||i==18||i==13)return;let r=this.getCharCode(t),n=String.fromCharCode(r),v=!0;if(!e.mozilla&&(this.isSpecialKey(t)||!n))return;let ye=(this.el.nativeElement.value||"")+n;v=this.regex.test(ye),v||t.preventDefault()}onPaste(t){let e=t.clipboardData||this.document.defaultView.clipboardData.getData("text");if(e){let i=/\{[0-9]+\}/,r=e.getData("text");if(i.test(this.regex.toString())){if(!this.regex.test(r)){t.preventDefault();return}}else for(let n of r.toString())if(!this.regex.test(n)){t.preventDefault();return}}}validate(t){if(this.pValidateOnly){let e=this.el.nativeElement.value;if(e&&!this.regex.test(e))return{validatePattern:!1}}}static \u0275fac=function(e){return new(e||a)(h(B),h(D),h(w))};static \u0275dir=K({type:a,selectors:[["","pKeyFilter",""]],hostBindings:function(e,i){e&1&&g("input",function(n){return i.onInput(n)})("keypress",function(n){return i.onKeyPress(n)})("paste",function(n){return i.onPaste(n)})},inputs:{pValidateOnly:[2,"pValidateOnly","pValidateOnly",T],pattern:[0,"pKeyFilter","pattern"]},outputs:{ngModelChange:"ngModelChange"},features:[P([xe])]})}return a})();function Ce(a,o){if(a&1&&(d(0,"h1",5),c(1),s()),a&2){let t=N();l(),C(" ",t.environment.APP_SHORT_NAME," ")}}var M=class a{_formBuilder=m(X);_customMessageService=m(ue);_authHttpService=m(pe);_authService=m(ce);_router=m(O);_reCaptchaV3Service=m(he);environment=ie;form;isRecaptcha=!0;constructor(){this.buildForm()}buildForm(){this.form=this._formBuilder.group({username:["admin",[b.required]],password:[null,[b.required]]})}executeRecaptcha(){this._reCaptchaV3Service.execute("submit").subscribe(o=>{this._authHttpService.verifyRecaptcha(o).subscribe(t=>{t.success?console.log(t):console.log("error")})})}onSubmit(){this._reCaptchaV3Service.execute("login").pipe(x(o=>this._authHttpService.verifyRecaptcha(o).pipe(S(t=>(console.error("Error en reCAPTCHA:",t),this._customMessageService.showError({summary:"Error de verificaci\xF3n",detail:"No se pudo verificar el reCAPTCHA"}),y(()=>t))))),x(o=>o?.success?this._authHttpService.signIn(this.form.value).pipe(S(t=>(console.error("Error en inicio de sesi\xF3n:",t),this._customMessageService.showError({summary:"Error de inicio de sesi\xF3n",detail:"No se pudo iniciar sesi\xF3n"}),y(()=>t)))):I(null))).subscribe({next:o=>{if(o&&this._authService.roles.length===0){this._customMessageService.showError({summary:"Sin Rol",detail:"No cuenta con un rol asignado"}),this._authService.removeLogin();return}this._router.navigateByUrl("")},error:o=>{console.error("Error general:",o)}})}getUsername(){return this.form.get("username")}getPassword(){return this.form.get("password")}PrimeIcons=L;static \u0275fac=function(t){return new(t||a)};static \u0275cmp=V({type:a,selectors:[["app-sign-in"]],decls:22,vars:9,consts:[[1,"bg-surface-50","dark:bg-surface-950","flex","items-center","justify-center","min-h-screen","min-w-[100vw]","overflow-hidden"],[1,"flex","flex-col","items-center","justify-center"],[2,"border-radius","56px","padding","0.4rem","background","linear-gradient(180deg, var(--primary-color) 10%, rgba(33, 150, 243, 0) 100%)"],[1,"w-full","bg-surface-0","dark:bg-surface-900","py-10","px-8","sm:px-6",2,"border-radius","53px"],[1,"text-center","mb-0"],[1,"text-red-500"],["src","images/logo.png","alt","","width","150"],[1,"text-surface-950","dark:text-surface-0","text-3xl","font-medium","mb-4"],[1,"text-muted-color","font-medium"],[3,"ngSubmit","formGroup"],["for","username",1,"block","text-surface-900","dark:text-surface-0","text-xl","font-medium","mb-2"],["pInputText","","pKeyFilter","int","id","username","type","text","placeholder","Ej. 1702030405","formControlName","username",1,"w-full","md:w-[39rem]","mb-4",3,"maxlength"],["for","password",1,"block","text-surface-900","dark:text-surface-0","font-medium","text-xl","mb-2"],["id","password","formControlName","password","placeholder","Ingrese su contrase\xF1a","styleClass","mb-4",3,"toggleMask","fluid","feedback"],["type","submit","label","Iniciar Sesi\xF3n","styleClass","w-full",3,"icon","disabled"]],template:function(t,e){t&1&&(u(0,"app-floating-configurator"),d(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4),R(6,Ce,2,1,"h1",5),u(7,"img",6),d(8,"div",7),c(9," Iniciar Sesi\xF3n "),s(),d(10,"span",8),c(11),s()(),d(12,"form",9),g("ngSubmit",function(){return e.onSubmit()}),d(13,"div")(14,"label",10),c(15," N\xFAmero de c\xE9dula: "),s(),u(16,"input",11),s(),d(17,"div")(18,"label",12),c(19," Contrase\xF1a: "),s(),u(20,"p-password",13),s(),u(21,"p-button",14),s()()()()()),t&2&&(l(6),k(e.environment.production?6:-1),l(5),C(" Bienvenido a ",e.environment.APP_NAME," "),l(),p("formGroup",e.form),l(4),p("maxlength",10),l(4),p("toggleMask",!0)("fluid",!0)("feedback",!1),l(),p("icon",e.PrimeIcons.SIGN_IN)("disabled",!e.isRecaptcha))},dependencies:[ne,re,ae,le,se,me,de,Z,q,$,z,Y,W,j,te,oe,ee,J,Q,fe,_],encapsulation:2})};export{M as default};
